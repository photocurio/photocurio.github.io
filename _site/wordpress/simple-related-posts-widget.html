<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">        
        <!-- header code from alexcican.com -->
        <title> A Simple Related Posts Widget |  Peter Mumford</title>
        <meta name="viewport" content="width=device-width">
		<link href='http://fonts.googleapis.com/css?family=Old+Standard+TT:400,400italic,700' rel='stylesheet'>
        <link rel="stylesheet" href="/css/style.css">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    </head>
    <body>
    <div id="wrapper" class="clearfix">

<div class="header clearfix">
	<div class="hgroup">
		<h1 class="sitename"><a href="/">Peter Mumford&rsquo;s <span>W</span>ordPress Dev Blog</a></h1>
		<h3 class="slogan">Problem Solving for Website Owners and Designers&nbsp; <i class='fa fa-umbrella fa-lg'></i></h2>
	</div>
	<p class="vcard">
		<span class="fn">Peter Mumford</span><br>
		<span class="locality">Somerville</span>, <span class="region">MA</span><br>
		<span class="email"><a href="mailto:sunraydust@gmail.com" >sunraydust@gmail.com</a></span><br>
		<span class="tel">781&middot;960&middot;7049</span>
	</p>
</div>        	

<div class="single clearfix">
	<div class="post">
		<div class="content">
			<h1 class="posttitle">A Simple Related Posts Widget</h1>
			<p class="meta">02 Dec 2013</p>
			<p>If you want to put some related posts in a widget you can use the smart <a href="http://wordpress.org/plugins/yet-another-related-posts-plugin/">YARPP</a> plugin. Or, if you merely want to list posts with matching tags, you can put a function in your Wordpress theme, or make your own plugin. </p>

<p>In some ways this is better than the fuzzy logic of YARPP because it gives you more control: you just give posts the same tag, and you know they are related. Plus, its easy to edit such simple code to suit (if you know how <a href="http://codex.wordpress.org/The_Loop">the loop</a> works). </p>

<p>Try this function to start:</p>

<div class="highlight"><pre><code class="php"><span class="cp">&lt;?php</span>
<span class="c1">// This function will list three posts in the sidebar with like tags.</span>
<span class="c1">// Activated by the shortcode [related-posts]</span>
<span class="k">function</span> <span class="nf">related_posts_widget</span><span class="p">()</span> <span class="p">{</span>
    <span class="nb">ob_start</span><span class="p">();</span>
    <span class="k">global</span> <span class="nv">$post</span><span class="p">;</span>
    <span class="nv">$tags</span> <span class="o">=</span> <span class="nx">wp_get_post_tags</span><span class="p">(</span> <span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span> <span class="p">);</span>
    <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$tags</span> <span class="k">as</span> <span class="nv">$tag</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nv">$tagID</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$tag</span><span class="o">-&gt;</span><span class="na">term_id</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$tagID</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$args</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;tag__in&#39;</span> <span class="o">=&gt;</span> <span class="nv">$tagID</span><span class="p">,</span>
            <span class="s1">&#39;post__not_in&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="nv">$post</span><span class="o">-&gt;</span><span class="na">ID</span><span class="p">),</span>
            <span class="s1">&#39;showposts&#39;</span> <span class="o">=&gt;</span> <span class="mi">3</span>
        <span class="p">);</span>
        <span class="nv">$related_query</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WP_Query</span><span class="p">(</span><span class="nv">$args</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span> <span class="nv">$related_query</span> <span class="o">-&gt;</span> <span class="na">have_posts</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">            &lt;ul&gt;</span>
<span class="x">            </span><span class="cp">&lt;?php</span> <span class="k">while</span> <span class="p">(</span><span class="nv">$related_query</span> <span class="o">-&gt;</span> <span class="na">have_posts</span><span class="p">())</span> <span class="o">:</span> <span class="nv">$related_query</span> <span class="o">-&gt;</span> <span class="na">the_post</span><span class="p">();</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">                &lt;li&gt;</span>
<span class="x">                    &lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="nx">the_permalink</span><span class="p">();</span> <span class="cp">?&gt;</span><span class="x">&quot; title=&quot;</span><span class="cp">&lt;?php</span> <span class="nx">the_title_attribute</span><span class="p">();</span> <span class="cp">?&gt;</span><span class="x">&quot; rel=&quot;bookmark&quot;&gt;</span>
<span class="x">                    </span><span class="cp">&lt;?php</span> <span class="nx">the_title</span><span class="p">();</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">                    &lt;/a&gt;</span>
<span class="x">                &lt;/li&gt;</span>
<span class="x">            </span><span class="cp">&lt;?php</span> <span class="k">endwhile</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">            &lt;/ul&gt;</span>
<span class="x">        </span><span class="cp">&lt;?php</span> <span class="p">}</span>
        <span class="nx">wp_reset_query</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="nv">$output</span> <span class="o">=</span> <span class="nb">ob_get_contents</span><span class="p">();</span>
    <span class="nb">ob_end_clean</span><span class="p">();</span>
    <span class="k">return</span> <span class="nv">$output</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">add_shortcode</span><span class="p">(</span><span class="s1">&#39;related-posts&#39;</span><span class="p">,</span><span class="s1">&#39;related_posts_widget&#39;</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>

<p>Also, for this to work you need to be able to put shortcodes in widgets, which does not work with the default WP installation. To enable shortcodes in widgets add this to your functions.php:
<code>add_filter(&#39;widget_text&#39;, &#39;do_shortcode&#39;);</code></p>

		</div>
	</div>
	<div id="sidebar">
	  <h4>Recent Posts</h4>
	  <ul>
	    
	      <li><a href="/wordpress/pagination-for-the-magazine-theme.html">Pagination for the Magazine Theme</a></li>
	    
	      <li><a href="/css3/soft-links.html">Soft link effects</a></li>
	    
	      <li><a href="/wordpress/switchable-one-time-or-recurring-paypal-donation-button.html">Switchable One-Time or Recurring Paypal Donation Button</a></li>
	    
	      <li><a href="/wordpress/categories-tags-and-custom-taxonomies-for-wordpress.html">Categories, Tags and Custom Taxonomies for WordPress</a></li>
	    
	      <li><a href="/wordpress/simple-related-posts-widget.html">A Simple Related Posts Widget</a></li>
	    
	      <li><a href="/wordpress/responsive-comment-forms.html">Responsive Comment Forms</a></li>
	    
	  </ul>
	</div>
</div>
		<div class="footer">
            <div class="contact">
              <p>
                Peter Mumford<br />
                Web Developer, WordPress Specialist<br />
                sunraydust@gmail.com
              </p>
            </div>
			<div class="contact">
              <p>
                <a href="https://github.com/photocurio">github.com/photocurio</a><br />
                <a href="https://twitter.com/photocurio">twitter.com/photocurio</a><br />
              </p>
            </div>
          </div>


      </div><!-- #wrapper -->
      <script>
            (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
            function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
            e=o.createElement(i);r=o.getElementsByTagName(i)[0];
            e.src='//www.google-analytics.com/analytics.js';
            r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
            ga('create','UA-46816784-1');ga('send','pageview');
        </script>
    </body>
</html>
